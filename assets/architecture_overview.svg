<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 1400">
  <defs>
    <linearGradient id="cardGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffffff"/>
      <stop offset="100%" style="stop-color:#fafafa"/>
    </linearGradient>
    <linearGradient id="accentGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#007AFF"/>
      <stop offset="100%" style="stop-color:#5856D6"/>
    </linearGradient>
    <filter id="cardShadow" x="-10%" y="-10%" width="120%" height="130%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.08"/>
    </filter>
    <filter id="subtleShadow" x="-5%" y="-5%" width="110%" height="115%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.05"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="1400" fill="#f5f5f7"/>
  
  <!-- Header -->
  <text x="450" y="50" text-anchor="middle" font-family="-apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif" font-size="32" font-weight="600" fill="#1d1d1f">Audar-TTS Architecture</text>
  <text x="450" y="80" text-anchor="middle" font-family="-apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif" font-size="15" fill="#86868b">Neural Codec Language Model with Zero-Shot Voice Cloning</text>
  
  <!-- SECTION 1: INPUTS -->
  <g transform="translate(50, 110)">
    <rect x="0" y="0" width="800" height="200" rx="16" fill="url(#cardGrad)" filter="url(#cardShadow)"/>
    
    <!-- Section header -->
    <rect x="0" y="0" width="800" height="44" rx="16" fill="#007AFF"/>
    <rect x="0" y="28" width="800" height="16" fill="#007AFF"/>
    <text x="24" y="28" font-family="-apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif" font-size="14" font-weight="600" fill="white" letter-spacing="0.5">INPUT STAGE</text>
    
    <!-- Reference Audio -->
    <g transform="translate(30, 60)">
      <rect x="0" y="0" width="230" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea" stroke-width="1"/>
      <circle cx="40" cy="40" r="24" fill="#34C759" opacity="0.15"/>
      <text x="40" y="45" text-anchor="middle" font-family="-apple-system" font-size="20">üé§</text>
      <text x="80" y="35" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="#1d1d1f">Reference Audio</text>
      <text x="80" y="52" font-family="-apple-system, 'SF Pro Text'" font-size="12" fill="#86868b">3-10 seconds WAV</text>
      <rect x="15" y="70" width="200" height="35" rx="6" fill="#fff" stroke="#e5e5ea"/>
      <path d="M30 87 Q50 75 70 87 Q90 99 110 87 Q130 75 150 87 Q170 99 190 87" stroke="#34C759" stroke-width="2" fill="none"/>
    </g>
    
    <!-- Reference Text -->
    <g transform="translate(285, 60)">
      <rect x="0" y="0" width="230" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea" stroke-width="1"/>
      <circle cx="40" cy="40" r="24" fill="#007AFF" opacity="0.15"/>
      <text x="40" y="45" text-anchor="middle" font-family="-apple-system" font-size="20">üìù</text>
      <text x="80" y="35" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="#1d1d1f">Reference Text</text>
      <text x="80" y="52" font-family="-apple-system, 'SF Pro Text'" font-size="12" fill="#86868b">Transcript of ref audio</text>
      <rect x="15" y="70" width="200" height="35" rx="6" fill="#fff" stroke="#e5e5ea"/>
      <text x="115" y="92" text-anchor="middle" font-family="'SF Mono', monospace" font-size="11" fill="#636366">"Hello, how are you?"</text>
    </g>
    
    <!-- Target Text -->
    <g transform="translate(540, 60)">
      <rect x="0" y="0" width="230" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea" stroke-width="1"/>
      <circle cx="40" cy="40" r="24" fill="#FF9500" opacity="0.15"/>
      <text x="40" y="45" text-anchor="middle" font-family="-apple-system" font-size="20">‚úçÔ∏è</text>
      <text x="80" y="35" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="#1d1d1f">Target Text</text>
      <text x="80" y="52" font-family="-apple-system, 'SF Pro Text'" font-size="12" fill="#86868b">New text to synthesize</text>
      <rect x="15" y="70" width="200" height="35" rx="6" fill="#fff" stroke="#e5e5ea"/>
      <text x="115" y="92" text-anchor="middle" font-family="'SF Mono', monospace" font-size="11" fill="#636366">"Welcome to Audar"</text>
    </g>
  </g>
  
  <!-- Arrow -->
  <path d="M450 320 L450 345" stroke="#c7c7cc" stroke-width="2" fill="none"/>
  <polygon points="445,340 450,350 455,340" fill="#c7c7cc"/>
  
  <!-- SECTION 2: ENCODING -->
  <g transform="translate(50, 360)">
    <rect x="0" y="0" width="800" height="220" rx="16" fill="url(#cardGrad)" filter="url(#cardShadow)"/>
    
    <rect x="0" y="0" width="800" height="44" rx="16" fill="#34C759"/>
    <rect x="0" y="28" width="800" height="16" fill="#34C759"/>
    <text x="24" y="28" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="white" letter-spacing="0.5">ENCODING STAGE</text>
    
    <!-- Neural Codec Encoder -->
    <g transform="translate(30, 60)">
      <rect x="0" y="0" width="350" height="140" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="20" y="28" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="#1d1d1f">Neural Codec Encoder</text>
      <text x="20" y="48" font-family="-apple-system, 'SF Pro Text'" font-size="12" fill="#86868b">DistillNeuCodec @ 50Hz</text>
      
      <rect x="20" y="60" width="310" height="65" rx="8" fill="#fff" stroke="#e5e5ea"/>
      <text x="35" y="82" font-family="'SF Mono', monospace" font-size="10" fill="#636366">Audio ‚Üí Discrete Codes [0-8191]</text>
      <text x="35" y="100" font-family="'SF Mono', monospace" font-size="10" fill="#34C759">50 codes/second = ~20ms per frame</text>
      <text x="35" y="115" font-family="'SF Mono', monospace" font-size="10" fill="#86868b">[127, 4521, 892, 3847, 156, ...]</text>
    </g>
    
    <!-- Phonemizer -->
    <g transform="translate(420, 60)">
      <rect x="0" y="0" width="350" height="140" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="20" y="28" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="#1d1d1f">Phonemizer (G2P)</text>
      <text x="20" y="48" font-family="-apple-system, 'SF Pro Text'" font-size="12" fill="#86868b">eSpeak NG Backend ‚Ä¢ EN/AR Bilingual</text>
      
      <rect x="20" y="60" width="310" height="65" rx="8" fill="#fff" stroke="#e5e5ea"/>
      <text x="35" y="82" font-family="'SF Mono', monospace" font-size="10" fill="#636366">Text ‚Üí IPA Phonemes</text>
      <text x="35" y="100" font-family="'SF Mono', monospace" font-size="10" fill="#007AFF">"Hello" ‚Üí /h…ôÀàlo ä/</text>
      <text x="35" y="115" font-family="'SF Mono', monospace" font-size="10" fill="#86868b">Auto code-switching for mixed text</text>
    </g>
  </g>
  
  <!-- Arrow -->
  <path d="M450 590 L450 615" stroke="#c7c7cc" stroke-width="2" fill="none"/>
  <polygon points="445,610 450,620 455,610" fill="#c7c7cc"/>
  
  <!-- SECTION 3: V2 TEMPLATE -->
  <g transform="translate(50, 630)">
    <rect x="0" y="0" width="800" height="280" rx="16" fill="url(#cardGrad)" filter="url(#cardShadow)"/>
    
    <rect x="0" y="0" width="800" height="44" rx="16" fill="#5856D6"/>
    <rect x="0" y="28" width="800" height="16" fill="#5856D6"/>
    <text x="24" y="28" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="white" letter-spacing="0.5">V2 PROMPT TEMPLATE ‚Ä¢ 8 EXPLICIT DELIMITERS</text>
    
    <!-- Template structure -->
    <g transform="translate(30, 55)">
      <rect x="0" y="0" width="740" height="200" rx="12" fill="#1d1d1f"/>
      
      <!-- Template content -->
      <text x="20" y="28" font-family="'SF Mono', monospace" font-size="11" fill="#86868b">user: Convert the text to speech:</text>
      
      <!-- REF_TEXT -->
      <text x="20" y="52" font-family="'SF Mono', monospace" font-size="11" fill="#34C759">&lt;|REF_TEXT_START|&gt;</text>
      <text x="165" y="52" font-family="'SF Mono', monospace" font-size="11" fill="#fff">{ref_phonemes}</text>
      <text x="285" y="52" font-family="'SF Mono', monospace" font-size="11" fill="#34C759">&lt;|REF_TEXT_END|&gt;</text>
      
      <!-- REF_SPEECH -->
      <text x="20" y="76" font-family="'SF Mono', monospace" font-size="11" fill="#007AFF">&lt;|REF_SPEECH_START|&gt;</text>
      <text x="185" y="76" font-family="'SF Mono', monospace" font-size="11" fill="#fff">&lt;|speech_127|&gt;&lt;|speech_4521|&gt;...</text>
      <text x="430" y="76" font-family="'SF Mono', monospace" font-size="11" fill="#007AFF">&lt;|REF_SPEECH_END|&gt;</text>
      
      <!-- TARGET_TEXT -->
      <text x="20" y="100" font-family="'SF Mono', monospace" font-size="11" fill="#FF9500">&lt;|TARGET_TEXT_START|&gt;</text>
      <text x="195" y="100" font-family="'SF Mono', monospace" font-size="11" fill="#fff">{target_phonemes}</text>
      <text x="335" y="100" font-family="'SF Mono', monospace" font-size="11" fill="#FF9500">&lt;|TARGET_TEXT_END|&gt;</text>
      
      <!-- Assistant response -->
      <text x="20" y="130" font-family="'SF Mono', monospace" font-size="11" fill="#86868b">assistant:</text>
      <text x="100" y="130" font-family="'SF Mono', monospace" font-size="11" fill="#FF3B30">&lt;|TARGET_CODES_START|&gt;</text>
      
      <!-- Generated codes -->
      <text x="20" y="154" font-family="'SF Mono', monospace" font-size="11" fill="#AF52DE">&lt;|speech_892|&gt;&lt;|speech_3847|&gt;&lt;|speech_156|&gt;...</text>
      <text x="340" y="154" font-family="'SF Mono', monospace" font-size="10" fill="#636366">‚Üê LLM generates these</text>
      
      <text x="20" y="178" font-family="'SF Mono', monospace" font-size="11" fill="#FF3B30">&lt;|TARGET_CODES_END|&gt;</text>
      <text x="200" y="178" font-family="'SF Mono', monospace" font-size="10" fill="#636366">‚Üê Stop token</text>
    </g>
    
    <!-- Legend -->
    <g transform="translate(30, 265)">
      <circle cx="8" cy="0" r="4" fill="#34C759"/>
      <text x="20" y="4" font-family="-apple-system" font-size="10" fill="#636366">Reference Context</text>
      <circle cx="150" cy="0" r="4" fill="#FF9500"/>
      <text x="162" y="4" font-family="-apple-system" font-size="10" fill="#636366">Target Input</text>
      <circle cx="270" cy="0" r="4" fill="#AF52DE"/>
      <text x="282" y="4" font-family="-apple-system" font-size="10" fill="#636366">Generated Output</text>
    </g>
  </g>
  
  <!-- Arrow -->
  <path d="M450 920 L450 945" stroke="#c7c7cc" stroke-width="2" fill="none"/>
  <polygon points="445,940 450,950 455,940" fill="#c7c7cc"/>
  
  <!-- SECTION 4: TRANSFORMER LLM -->
  <g transform="translate(50, 960)">
    <rect x="0" y="0" width="800" height="200" rx="16" fill="url(#cardGrad)" filter="url(#cardShadow)"/>
    
    <rect x="0" y="0" width="800" height="44" rx="16" fill="#AF52DE"/>
    <rect x="0" y="28" width="800" height="16" fill="#AF52DE"/>
    <text x="24" y="28" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="white" letter-spacing="0.5">TRANSFORMER LANGUAGE MODEL</text>
    
    <!-- Model specs -->
    <g transform="translate(30, 60)">
      <rect x="0" y="0" width="180" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="90" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Architecture</text>
      <text x="90" y="50" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">Qwen 0.5B Backbone</text>
      <text x="90" y="70" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">24 Decoder Layers</text>
      <text x="90" y="90" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">Grouped Query Attn</text>
      <text x="90" y="110" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">RMSNorm ‚Ä¢ SwiGLU</text>
    </g>
    
    <g transform="translate(230, 60)">
      <rect x="0" y="0" width="180" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="90" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Vocabulary</text>
      <text x="90" y="50" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#AF52DE">8,192 Speech Codes</text>
      <text x="90" y="70" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">+ Text Tokens</text>
      <text x="90" y="90" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">+ 8 Delimiters</text>
      <text x="90" y="110" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">Unified Embedding</text>
    </g>
    
    <g transform="translate(430, 60)">
      <rect x="0" y="0" width="180" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="90" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Inference</text>
      <text x="90" y="50" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#007AFF">GGUF Q8_0 Format</text>
      <text x="90" y="70" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">~800MB Model</text>
      <text x="90" y="90" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">llama-cpp-python</text>
      <text x="90" y="110" text-anchor="middle" font-family="-apple-system" font-size="12" fill="#86868b">8192 Context Window</text>
    </g>
    
    <g transform="translate(630, 60)">
      <rect x="0" y="0" width="140" height="120" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="70" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Generation</text>
      <text x="70" y="50" text-anchor="middle" font-family="-apple-system" font-size="11" fill="#86868b">top_k=40</text>
      <text x="70" y="70" text-anchor="middle" font-family="-apple-system" font-size="11" fill="#86868b">top_p=0.95</text>
      <text x="70" y="90" text-anchor="middle" font-family="-apple-system" font-size="11" fill="#86868b">temp=0.3</text>
      <text x="70" y="110" text-anchor="middle" font-family="-apple-system" font-size="11" fill="#86868b">repeat_pen=1.1</text>
    </g>
  </g>
  
  <!-- Arrow -->
  <path d="M450 1170 L450 1195" stroke="#c7c7cc" stroke-width="2" fill="none"/>
  <polygon points="445,1190 450,1200 455,1190" fill="#c7c7cc"/>
  
  <!-- SECTION 5: OUTPUT -->
  <g transform="translate(50, 1210)">
    <rect x="0" y="0" width="800" height="170" rx="16" fill="url(#cardGrad)" filter="url(#cardShadow)"/>
    
    <rect x="0" y="0" width="800" height="44" rx="16" fill="#FF3B30"/>
    <rect x="0" y="28" width="800" height="16" fill="#FF3B30"/>
    <text x="24" y="28" font-family="-apple-system, 'SF Pro Display'" font-size="14" font-weight="600" fill="white" letter-spacing="0.5">OUTPUT DECODING</text>
    
    <!-- Code Extraction -->
    <g transform="translate(30, 60)">
      <rect x="0" y="0" width="240" height="90" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="120" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Token ‚Üí Code</text>
      <text x="120" y="50" text-anchor="middle" font-family="'SF Mono', monospace" font-size="10" fill="#636366">&lt;|speech_X|&gt; ‚Üí int(X)</text>
      <text x="120" y="75" text-anchor="middle" font-family="'SF Mono', monospace" font-size="10" fill="#86868b">[892, 3847, 156, ...]</text>
    </g>
    
    <!-- Neural Codec Decoder -->
    <g transform="translate(290, 60)">
      <rect x="0" y="0" width="240" height="90" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="120" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Codec Decoder</text>
      <text x="120" y="50" text-anchor="middle" font-family="-apple-system" font-size="11" fill="#86868b">DistillNeuCodec</text>
      <text x="120" y="75" text-anchor="middle" font-family="-apple-system" font-size="11" fill="#34C759">Codes ‚Üí 24kHz Waveform</text>
    </g>
    
    <!-- Audio Output -->
    <g transform="translate(550, 60)">
      <rect x="0" y="0" width="220" height="90" rx="12" fill="#f5f5f7" stroke="#e5e5ea"/>
      <text x="110" y="25" text-anchor="middle" font-family="-apple-system, 'SF Pro Display'" font-size="13" font-weight="600" fill="#1d1d1f">Audio Output</text>
      <rect x="20" y="40" width="180" height="35" rx="6" fill="#fff" stroke="#e5e5ea"/>
      <path d="M35 57 Q55 45 75 57 Q95 69 115 57 Q135 45 155 57 Q175 69 185 57" stroke="#FF3B30" stroke-width="2" fill="none"/>
    </g>
  </g>
  
  <!-- Footer metrics -->
  <g transform="translate(50, 1390)">
    <text x="0" y="0" font-family="-apple-system" font-size="11" fill="#86868b">RTF: 0.46x</text>
    <text x="100" y="0" font-family="-apple-system" font-size="11" fill="#86868b">‚Ä¢</text>
    <text x="120" y="0" font-family="-apple-system" font-size="11" fill="#86868b">First Chunk: 500ms</text>
    <text x="260" y="0" font-family="-apple-system" font-size="11" fill="#86868b">‚Ä¢</text>
    <text x="280" y="0" font-family="-apple-system" font-size="11" fill="#86868b">50 codes/sec</text>
    <text x="380" y="0" font-family="-apple-system" font-size="11" fill="#86868b">‚Ä¢</text>
    <text x="400" y="0" font-family="-apple-system" font-size="11" fill="#86868b">24kHz Output</text>
    <text x="510" y="0" font-family="-apple-system" font-size="11" fill="#86868b">‚Ä¢</text>
    <text x="530" y="0" font-family="-apple-system" font-size="11" fill="#86868b">Bilingual EN/AR</text>
  </g>
  
</svg>